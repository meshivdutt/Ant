-- Check for unmatched MEDICATION_PROBLEM_LIST_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_MEDICATION_PROBLEM_LIST_KEY NOT IN (
    SELECT CDM_MEDICATION_PROBLEM_LIST_KEY 
    FROM [CDM].[TBL_MEDICATION_PROBLEM_LIST_KEY] WITH (NOLOCK)
);

-- Check for unmatched AUTHORIZING_PRACTITIONER_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_AUTHORIZING_PRACTITIONER_KEY NOT IN (
    SELECT CDM_PRACTITIONER_KEY 
    FROM [CDM].[TBL_PRACTITIONER_KEY] WITH (NOLOCK)
);

-- Check for unmatched DEPARTMENT_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_DEPARTMENT_KEY NOT IN (
    SELECT CDM_DEPARTMENT_KEY 
    FROM [CDM].[TBL_DEPARTMENT_KEY] WITH (NOLOCK)
);

-- Check for unmatched MEDICATION_FREQUENCY_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_MEDICATION_FREQUENCY_KEY NOT IN (
    SELECT CDM_MEDICATION_FREQUENCY_KEY 
    FROM [CDM].[TBL_MEDICATION_FREQUENCY_KEY] WITH (NOLOCK)
);

-- Check for unmatched MEDICATION_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_MEDICATION_KEY NOT IN (
    SELECT CDM_MEDICATION_KEY 
    FROM [CDM].[TBL_MEDICATION_KEY] WITH (NOLOCK)
);

-- Check for unmatched MEDICATION_ORDER_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_MEDICATION_ORDER_KEY NOT IN (
    SELECT CDM_MEDICATION_ORDER_KEY 
    FROM [CDM].[TBL_MEDICATION_ORDER_KEY] WITH (NOLOCK)
);

-- Check for unmatched PATIENT_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_PATIENT_KEY NOT IN (
    SELECT CDM_PATIENT_KEY 
    FROM [CDM].[TBL_PATIENT_KEY] WITH (NOLOCK)
);

-- Check for unmatched PHARMACY_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_PHARMACY_KEY NOT IN (
    SELECT CDM_PHARMACY_KEY 
    FROM [CDM].[TBL_PHARMACY_KEY] WITH (NOLOCK)
);

-- Check for unmatched ORDERING_PRACTITIONER_KEY
SELECT COUNT(*) 
FROM [CDM].[TBL_MEDICATION_ORDER_DETAILS] WITH (NOLOCK)
WHERE CDM_ORDERING_PRACTITIONER_KEY NOT IN (
    SELECT CDM_PRACTITIONER_KEY 
    FROM [CDM].[TBL_PRACTITIONER_KEY] WITH (NOLOCK)
);
