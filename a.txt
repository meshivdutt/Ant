ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [fk_CDM_MEDICATION_PROBLEM_LIST_KEY] FOREIGN KEY([CDM_MEDICATION_PROBLEM_LIST_KEY])

REFERENCES [CDM].[TBL_MEDICATION_PROBLEM_LIST_KEY] ([CDM_MEDICATION_PROBLEM_LIST_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [fk_CDM_MEDICATION_PROBLEM_LIST_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_AUTHORIZING_PRACTITIONER_KEY] FOREIGN KEY([CDM_AUTHORIZING_PRACTITIONER_KEY])

REFERENCES [CDM].[TBL_PRACTITIONER_KEY] ([CDM_PRACTITIONER_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_AUTHORIZING_PRACTITIONER_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_DEPARTMENT_KEY] FOREIGN KEY([CDM_DEPARTMENT_KEY])

REFERENCES [CDM].[TBL_DEPARTMENT_KEY] ([CDM_DEPARTMENT_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_DEPARTMENT_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_FREQUENCY_KEY] FOREIGN KEY([CDM_MEDICATION_FREQUENCY_KEY])

REFERENCES [CDM].[TBL_MEDICATION_FREQUENCY_KEY] ([CDM_MEDICATION_FREQUENCY_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_FREQUENCY_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_KEY] FOREIGN KEY([CDM_MEDICATION_KEY])

REFERENCES [CDM].[TBL_MEDICATION_KEY] ([CDM_MEDICATION_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_ORDER_DETAILS_KEY] FOREIGN KEY([CDM_MEDICATION_ORDER_KEY])

REFERENCES [CDM].[TBL_MEDICATION_ORDER_KEY] ([CDM_MEDICATION_ORDER_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_ORDER_DETAILS_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_PATIENT_KEY] FOREIGN KEY([CDM_PATIENT_KEY])

REFERENCES [CDM].[TBL_PATIENT_KEY] ([CDM_PATIENT_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_PATIENT_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_PHARMACY_KEY] FOREIGN KEY([CDM_PHARMACY_KEY])

REFERENCES [CDM].[TBL_PHARMACY_KEY] ([CDM_PHARMACY_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_PHARMACY_KEY]

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_MEDICATION_PRACTITIONER_KEY] FOREIGN KEY([CDM_ORDERING_PRACTITIONER_KEY])

REFERENCES [CDM].[TBL_PRACTITIONER_KEY] ([CDM_PRACTITIONER_KEY])

GO
 
ALTER TABLE [CDM].[TBL_MEDICATION_ORDER_DETAILS] CHECK CONSTRAINT [FK_MEDICATION_PRACTITIONER_KEY]

GO

from this queries create sample queries like this

select count(*) from [CDM].[TBL_MEDICATION_ORDER_DETAILS] with(nolock) where CDM_PATIENT_ENCOUNTER_KEY not in

(select CDM_PATIENT_ENCOUNTER_KEY from refined.cdm.[TBL_PATIENT_ENCOUNTER_KEY] with(nolock)  ) 

 
