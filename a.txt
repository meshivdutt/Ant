ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_EFFECTIVE_DEPARTMENT_KEY] FOREIGN KEY([CDM_EFFECTIVE_DEPTARTMENT_KEY])

REFERENCES [CDM].[TBL_DEPARTMENT_KEY] ([CDM_DEPARTMENT_KEY])

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS] CHECK CONSTRAINT [FK_EFFECTIVE_DEPARTMENT_KEY]

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_ENC_COVERAGE_KEY] FOREIGN KEY([CDM_Patient_Coverage_Key])

REFERENCES [CDM].[TBL_PATIENT_COVERAGE_KEY] ([CDM_PATIENT_COVERAGE_KEY])

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS] CHECK CONSTRAINT [FK_ENC_COVERAGE_KEY]

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_ENC_DEPT_KEY] FOREIGN KEY([CDM_Department_Key])

REFERENCES [CDM].[TBL_DEPARTMENT_KEY] ([CDM_DEPARTMENT_KEY])

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS] CHECK CONSTRAINT [FK_ENC_DEPT_KEY]

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS]  WITH CHECK ADD  CONSTRAINT [FK_ENC_PATIENT_KEY] FOREIGN KEY([CDM_Patient_Key])

REFERENCES [CDM].[TBL_PATIENT_KEY] ([CDM_PATIENT_KEY])

GO
 
ALTER TABLE [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS] CHECK CONSTRAINT [FK_ENC_PATIENT_KEY]

GO

 
from this queries create sample queries like this
 
select count(*) from [CDM].[TBL_PATIENT_ENCOUNTER_DETAILS] with(nolock) where CDM_PATIENT_ENCOUNTER_KEY not in

(select CDM_PATIENT_ENCOUNTER_KEY from refined.cdm.[TBL_PATIENT_ENCOUNTER_KEY] with(nolock)  )
 
